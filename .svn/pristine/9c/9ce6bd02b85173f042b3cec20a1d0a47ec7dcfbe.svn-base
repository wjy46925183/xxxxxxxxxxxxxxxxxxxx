package com.dlg.personal.wallet.activity;

import android.os.Bundle;
import android.support.annotation.Nullable;
import android.view.View;
import android.widget.TextView;

import com.dlg.data.wallet.model.WalletBean;
import com.dlg.personal.R;
import com.dlg.personal.app.ActivityNavigator;
import com.dlg.personal.base.BaseActivity;
import com.dlg.personal.base.ToolBarType;
import com.dlg.viewmodel.Wallet.WalletViewModel;
import com.dlg.viewmodel.Wallet.presenter.WalletPresenter;

/**
 * Created by Administrator on 2017/7/6.
 * pro : 钱包
 */

public class WalletActivity extends BaseActivity implements WalletPresenter{
    private TextView tvAmount;  //金额，设置的时候需要把¥拼接上去
    private TextView tvCount;   //金橙数量，设置的时候需要把"个"拼接上去
    private TextView tvRecharge;    //充值
    private TextView tvWithdrawal;  //提现
    private TextView tvVoucher;     //兑换券
    private TextView tvInvoiceManage;   //发票管理
    private TextView tvSetting;     //设置
    private WalletViewModel viewModel ;
    private WalletBean bean ;

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.page_wallet, ToolBarType.Default);
        mToolBarHelper.setToolbarTitle("我的钱包");
        mToolBarHelper.setToolbarTextRight("明细");
        viewModel = new WalletViewModel(this,this,this);
        initView();
        addListener();
        initData();
    }

    /**
     *
     */
    private void initData() {
//        viewModel.getWalletBalance();
    }

    /**
     * 控件的初始化操作
     */
    private void initView() {
        tvAmount = (TextView) findViewById(R.id.tv_amount);
        tvCount = (TextView) findViewById(R.id.tv_count);
        tvRecharge = (TextView) findViewById(R.id.tv_recharge);
        tvWithdrawal = (TextView) findViewById(R.id.tv_withdrawal);
        tvVoucher = (TextView) findViewById(R.id.tv_voucher);
        tvInvoiceManage = (TextView) findViewById(R.id.tv_invoice_manage);
        tvSetting = (TextView) findViewById(R.id.tv_setting);
    }

    @Override
    protected void onResume() {
        super.onResume();
        viewModel.getWalletBalance();
    }

    /**
     * 控件的监听事件
     */
    private void addListener() {
        /**
         * 充值点击事件
         */
        tvRecharge.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                ActivityNavigator.navigator().navigateTo(RechargeActivity.class);
            }
        });

        /**
         * 提现点击事件
         */
        tvWithdrawal.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Bundle bundle = new Bundle();
                bundle.putSerializable("bean",bean);
                ActivityNavigator.navigator().navigateTo(WithdrawalActivity.class,bundle);
            }
        });

        /**
         * 兑换券点击事件
         */
        tvVoucher.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                ActivityNavigator.navigator().navigateTo(ExchangeActivity.class);
            }
        });

        /**
         * 发票管理点击事件
         */
        tvInvoiceManage.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                ActivityNavigator.navigator().navigateTo(InvoiceActivity.class);
            }
        });

        /**
         * 设置点击事件
         */
        tvSetting.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {

            }
        });

        /**
         * 明细的点击事件
         */
        mToolBarHelper.getToolbarTextRight().setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                ActivityNavigator.navigator().navigateTo(WalletDetailActivity.class);
            }
        });
    }


    @Override
    public void toMap(WalletBean bean) {
        this.bean = bean ;
        tvAmount.setText("¥   " + bean.getAmount());
        tvCount.setText(Double.valueOf(bean.getAmount())*10 + "个");
    }
}
